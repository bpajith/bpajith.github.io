<!DOCTYPE html>
<html lang="en" style="scroll-behavior: smooth">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

  

  
    
      <link rel="stylesheet" href="/semantic/dist/semantic.min.css" />
    
      <link rel="stylesheet" href="/assets/css/product.css" />
    
      <link rel="stylesheet" href="/assets/css/highlight.css" />
    
  

  

  

  

  

  
  
  
  

    <!-- Facebook OpenGraph tags -->
  

  
  <meta property="og:title" content="Second Order Ordinary Differential Equations" />
  


   
  <meta property="description" content="Numerical methods to solve second order ODEs in Python">
  

   
  <meta property="og:description" content="Numerical methods to solve second order ODEs in Python">
  

   
  <meta name="description" content="Numerical methods to solve second order ODEs in Python">
  


  
  
  


  <meta property="og:type" content="website" />

  
  <meta property="og:url" content="http://localhost:4000/ODE/ode2/" />
  <link rel="canonical" href="http://localhost:4000/ODE/ode2/" />
  


  <meta property="og:image" content="http://localhost:4000/assets/images/avatar-icon.jpg" />


  <!-- Twitter summary cards -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@csparkresearch" />
  <meta name="twitter:creator" content="@csparkresearch" />

  
  <meta name="twitter:title" content="Second Order Ordinary Differential Equations" />
  

  
  <meta name="twitter:description" content="Instrumentation and Engineering">
  

  <meta name="twitter:image" content="http://localhost:4000/assets/images/avatar-icon.jpg" />



<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-67472997-3"></script>
<script>
	var host = window.location.hostname;
	if(host == "localhost")
	{
		console.log('Developer Mode');
		window['ga-disable-UA-3'] = true;
	}

  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', '');



</script>


 <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
        inlineMath: [['$','$']]
      }
    });
  </script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>


    <title>Second Order Ordinary Differential Equations</title>


</head>


<body>

<!-- Sidebar Menu -->
<div class="ui sidebar large vertical menu">
    <a class="header item" href="/"><img class="ui image small" src="/assets/images/logo.png" /></a>
	
        <div class="ui item">
			Resources
			<i class="dropdown icon"></i>
			<div class="menu">
              
              <a class=" item" href="/python/index">Python for Education</a>

              
			</div>
		  </div>        
        
    
        <div class="ui item">
			Books
			<i class="dropdown icon"></i>
			<div class="menu">
              
              <a class=" item" href="/books/science">Science</a>

              
			</div>
		  </div>        
        
    
        <div class="ui item">
			Blog
			<i class="dropdown icon"></i>
			<div class="menu">
              
              <a class=" item" href="/blog">Blog</a>

              
			</div>
		  </div>        
        
    
</div>



<!-- Page Contents -->
<div class="pusher">
	
  <div class="ui inverted vertical center aligned segment" style="background:url(/assets/images/cover.jpg) #f2bd91 fixed top center; " >

    <div class="ui container">
		<div class="ui menu large inverted secondary pointing">
	<div class="sidebar reveal float left">
		<a class="toc item overlay blog fixed">
		  <i class="icon list layout large"></i><span class="text">Menu</span>
		</a>
	</div>
	<div class=" item">
		<img src="/assets/images/avatar-icon.png">
		<a href="/" class="ui inverted blue button">Home</a>
    </div>
	
        <div class="ui dropdown item">
			Resources
			<i class="dropdown icon"></i>
			<div class="menu">
              
              <a class=" item" href="/python/index">Python for Education</a>

              
			</div>
		  </div>        
        
    
        <div class="ui dropdown item">
			Books
			<i class="dropdown icon"></i>
			<div class="menu">
              
              <a class=" item" href="/books/science">Science</a>

              
			</div>
		  </div>        
        
    
        <div class="ui dropdown item">
			Blog
			<i class="dropdown icon"></i>
			<div class="menu">
              
              <a class=" item" href="/blog">Blog</a>

              
			</div>
		  </div>        
        
    

  <div class="right menu">
    <!--<div class="item">
      <div class="ui action left icon input">
        <i class="search icon"></i>
        <input type="text" placeholder="Search">
        <button class="ui button">Submit</button>
      </div>
    </div>-->
  </div>

</div>

    </div>

    <div class="ui text container">
      <h1 class="ui inverted header">
        Second Order Ordinary Differential Equations
      </h1>
      <h2>Numerical methods to solve second order ODEs in Python</h2>
      <!--<div class="ui huge primary button">Get Started <i class="right arrow icon"></i></div> -->
    </div>
  </div>

	

	
	<div class="ui clearing divider"></div>	

	
	<div class="ui container" >
	<p>In order to solve a second order differential equation using numerical
methods we need to convert it in to two coupled first order equations,
as shown below.</p>

<blockquote>
  <p>$\frac{d^2 x}{dt^2}  = \frac{d}{dt}\Bigg( \frac{dx}{dt} \Bigg) = f(x,t)$
can be converted in to two coupled equations,</p>

  <p>$\frac{dx1}{dt} = f1(x1,x2,t)$ ; $\frac{dx2}{dt} = f2(x1,x2,t)$</p>
</blockquote>

<h2 id="mass-and-spring-system">Mass and Spring system</h2>

<p>Let us take the equation for the mass-spring problem equation as an
example. The equation for the mass-spring problem</p>

<blockquote>
  <p>$\frac{d^2 x}{dt^2} = -kx^2$</p>
</blockquote>

<p>can be written as two coupled equations</p>

<blockquote>
  <p>$\frac{dx1}{dt} = x2$</p>

  <p>$\frac{dx2}{dt} = -kx1$</p>
</blockquote>

<h2 id="euler-method">Euler method</h2>

<p><a href="code/ms-euler-1.py">ms-euler-1.py</a>.</p>

<p>``` {.sourceCode .python}
k = 10.0    # spring constant
m = 1.0
dt = 0.1
t = 0
x = 2.0     # initial displacement
v = 0.0     # initial velocity</p>

<p>ta = [t]   # list for time, add start time
xa = [x]   # list for displacement, x = 2 at t= 0
va = [v]   # list for velocity, v=0 at t=0</p>

<p>while t &lt; 5:
    f = -k * x
    v =  v + (f/m) * dt   # a = F/m;  a = dv/dt
    x =  x + v * dt         # v = dx/dt
    t = t + dt
    ta.append(t)
    xa.append(x)
    va.append(v)</p>

<p>import matplotlib.pyplot as plt
plt.plot(ta, xa)
plt.plot(ta, va)
plt.show()</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
![image](pics/ms-euler-1.png){width="400px"}

Displacement and velocity are plotted as a function of time. The
sinusoidal nature of the oscillations are evident from the plot.
However, the way in which the program is written does not show the
connection with our equations explicitly. It will be important when we
move on to other methods like Runge-Kutta, and we re-write the program
as shown below.

[ms-euler-2.py](code/ms-euler-2.py).

``` {.sourceCode .python}
import numpy as np
import matplotlib.pyplot as plt

k = 10.0    # spring constant
m = 1.0
dt = .1
tmax = 5
ta = np.arange(0, tmax, dt)     # array of time
N =len(ta)

def f1(x1,x2,t):        # dx1/dt is x2
    dx1dt = x2
    return dx1dt

def f2(x1,x2,t):
    dx2dt = -k * x1 / m    
    return dx2dt

def euler(x1,x2, f1, f2, t):
    x1 += dt * f1(x1,x2,t)
    x2 += dt * f2(x1,x2,t)
    return x1,x2

x1a = np.zeros(N)       # array to store the computed displacements
x2a = np.zeros(N)       # and velocities
x1 = 2
x2 = 0
x1a[0] = x1             # initial value of displacement
x2a[0] = x2             # and position are filled

for i in range(N-1):
    x1a[i+1], x2a[i+1] = euler(x1a[i], x2a[i], f1, f2, dt)  

plt.plot(ta, x1a)
plt.plot(ta, x2a)
plt.show() 
</code></pre></div></div>

<p>Output of this program will be identical to that of the first one. But
we have added some code to fit the calculated displacement graph using
sine function and extract the frequency. This is compared with the
analytical result f=sqrt(k/m)/2pi. Modify the code to see the effect of
‘dt’ on the error.</p>

<p>``` {.sourceCode .python}
def sineFunc(x, a1, a2, a3, a4):
    return a4 + a1* np.sin(abs(a2<em>(2</em>np.pi))*x + a3)</p>

<p>import scipy.optimize as optimize</p>

<p>fr = np.sqrt(k/m)/2/np.pi
par = [x1a[0], fr, 0.0, 0.0]    # Amp, freq, phase , offset
par, pcov = optimize.curve_fit(sineFunc, ta, x1a, par)
print(‘Frequencies ‘, fr, par[1])</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Runge-Kutta method
------------------

The code can be modified just by replacing the euler function with a one
implementing fourth order Runge-Kutta method.

[ms-rk4.py](code/ms-rk4.py).

The Runge-Kutta function that replaces the Euler funtion is listed
below. The output of the program is also shown.

``` {.sourceCode .python}
def rk4(x1,x2, f1, f2, t):
    k11 = dt*f1(x1,x2,t);
    k21 = dt*f2(x1,x2,t);
    k12 = dt*f1(x1+0.5*k11,x2+0.5*k21,t+0.5*dt);
    k22 = dt*f2(x1+0.5*k11,x2+0.5*k21,t+0.5*dt);
    k13 = dt*f1(x1+0.5*k12,x2+0.5*k22,t+0.5*dt);
    k23 = dt*f2(x1+0.5*k12,x2+0.5*k22,t+0.5*dt);
    k14 = dt*f1(x1+k13,x2+k23,t+dt);
    k24 = dt*f2(x1+k13,x2+k23,t+dt);
    x1 += (k11+2*k12+2*k13+k14)/6;
    x2 += (k21+2*k22+2*k23+k24)/6;
    return x1,x2
</code></pre></div></div>

<p><img src="pics/ms-rk4.png" alt="image" />{width=”400px”}</p>

	</div>
	

	<div class="ui grid">
		<div class="row">
			<div class = "ui column  wide">
				<div class="ui container">
					
					
				</div>

		</div>
	</div>

 
      </div>
    </div>
  </div>


  </div>











  
	<script src="/assets/js/jquery.min.js"></script>
  
	<script src="/semantic/dist/semantic.min.js"></script>
  
	<script src="/assets/js/mainsemantic.js"></script>
  
	<script src="/assets/js/toc.js"></script>
  





</body>
</html> 


